<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Task 11: Write a function that formats a string using placeholders.</title>
    <link href="styles/js-console.css" rel="stylesheet" />
</head>
<body>
    <div>Task 11: Write a function that formats a string using placeholders.</div>
    <label for="tb-placeholder">Text with placeholders: </label>
    <input type="text" name="tb-text" id="tb-placeholder" value="{0}, {1}, {0} text {2}" readonly="readonly" />
    <label for="tb-args">Arguments to replace placeholders (splited by comma): </label>
    <input type="text" name="tb-args" id="tb-args" value="1,Pesho,Gosho" readonly="readonly" />
    <a href="#" id="btn-check-prime" onclick="onBtnClick()">Check</a>
    <div id="js-console">
    </div>
    <script src="script/js-console.js"></script>
    <script>

        function onBtnClick() {
            jsConsole.writeLine("Test data are fixed, but function can hold any number of placeholders.<br> Reslut: ");
            var source = jsConsole.read("#tb-placeholder");
            jsConsole.writeLine(stringFormat(source, 1, "Pesho", "Gosho"));
        }

        function stringFormat(source) {
            // checks the provided arguments and extracts one (first) as it is the string to be modified
            var argsNumber = arguments.length - 1;
            var target = "";
            var position = 0;
            var index = 0;
            var tempString = "";
            var replacement = false;
            while (true) {
                index = source.indexOf("{", position++);
                if (index < 0) {
                    // there is no placeholders, but in order to copy the noraml tezt we define a fake replacment
                    replacement = true;
                    break;
                }
                if (argsNumber < 10) {
                    if (source.charAt(index + 2) === "}") {
                        // it is a single number placeholder and we are replacing it with corresponding value from arguments array by adding it to current target string
                        var argIndex = parseInt(source.charAt(index + 1)) + 1;
                        tempString = arguments[argIndex];
                        target += source.slice(--position, index) + tempString;
                        position = index + 3;
                        if (arguments[argIndex] === undefined) {
                            replacement = true;
                        }
                    }
                }
                else {
                    if (source[index + 3] === "}") {
                        // it is a double number placeholder and we are replacing it with corresponding value from arguments array by adding it to current target string
                        var argIndex = parseInt(source.slice(index + 1, index + 2)) + 1;
                        tempString = arguments[argIndex];
                        target += source.slice(--position, index) + tempString;
                        position = index + 4;
                        if (arguments[argIndex] === undefined) {
                            replacement = true;
                        }                   
                    }
                }
            }
            // if there was a replacement copy the rest of the source string if any and paste it to target string
            if (--position < source.length && replacement) {
                target += source.slice(position);
            }
            // return new formet string with replaced placeholders
            return target;
        }


    </script>
</body>
</html>

